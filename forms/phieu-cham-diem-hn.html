<!DOCTYPE html>
<html lang="en" id="bieumau">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MẪU CĐ3</title>
<link rel="stylesheet" href="./../styles/style.css">
<link rel="stylesheet" href="./../styles/cross-platform.css">
<link rel="stylesheet" href="./../styles/common.css">
<link rel="stylesheet" href="./../styles/forms.css">
<link rel="stylesheet" href="./../styles/print.css" media="print">
<script language="javascript" src="./../js/chamdiem.js"></script>
<script language="javascript" src="./../js/xuongdong.js"></script>
<script type='text/javascript'>
function save() {
  var htmlContent = ['<!DOCTYPE html>', '<html lang="en" id="bieumau">',
                     document.getElementById('bieumau').innerHTML, '</html>',
                     '<img src="./../images/print.png" class="button_print" width="50px" height="50px" onclick="In_bieu_mau();">',
                     '<img src="./../images/save.png" class="button_save" width="45px" height="45px" onclick="save()">',
                     '<img src="./../images/reload.png" class="button_reload" width="45px" height="45px" onclick="window.location.reload(true);">'].join('\n');
  var bl = new Blob(htmlContent, {type: "text/html"});
  var a = document.createElement("a");
  a.href = URL.createObjectURL(bl);
  a.download = document.title + ".html";
  a.hidden = true;
  document.body.appendChild(a);
  a.click();
}
function In_bieu_mau() {
  window.print();
}
</script>
</head>
<body class="font14 ta_jus" onkeyup='cong_diem()'>
  <header class="main-header" style="text-align: center;">
    <h1>Hệ thống chấm điểm HSNV</h1>
  </header>
  <div class="wrapper border" >
    <div class="content_mau_pa">
      <div class="cq_banhanh_mau_pa f_left ta_center font12">
        <!--Số: <span class="o_nhap_1cm ta_left border" contenteditable=""></span>/QD <span class="o_nhap_1cm ta_left border" contenteditable=""></span>-->
      </div>
      <div class="td_bieumau ta_center f_right lh_08">
        <span class=" fontBold" style='font-size: 13.3px'>MẪU CĐ3</span><br>
        <div class='lh_06' style='margin-top:5px'>
          <span class=" " style='font-size:12px'> Ban hành kèm theo </span> <br>
          <span class=" " style='font-size:12px'> Thông tư số </span> <br>
          <span class=" " style='font-size:12px'> 17/2025/TT-BCA </span> <br>
          <span class=" " style='font-size:12px'> ngày 28/02/2025 </span> <br>
        </div>
      </div>
      <br> <br>
      <div style="text-align: center;" class="font14 clean">
        <b>PHIẾU CHẤM ĐIỂM, XẾP LOẠI</b><br>
        <div style="display: inline-block; text-align: center;">
          <div class="font13 clean"><b>Công tác hiềm nghi của lực lượng Cảnh sát nhân dân</b></div>
          <div style="min-height: 1px; border-top: 1px solid black; width: 2cm; margin: 4px auto 0 auto;"></div>
        </div>
      </div>
      <br>
      <span class='TAB'></span>Họ và tên: <span class='o_nhap_1cm border' contenteditable style='min-width:500px'></span><br>
      <span class='TAB'></span>Cấp bậc: <span class='o_nhap_1cm border' contenteditable style='min-width: 200px'></span>
      <span class='TAB'></span>Chức vụ: <span class='o_nhap_1cm border' contenteditable style='min-width: 200px'></span> <br>
      <span class= 'TAB'></span>Đơn vị: <span class='o_nhap_thang border' contenteditable style='min-width:400px'></span><br>
      <span class='TAB'></span>Tên đối tượng hiềm nghi (HN) chủ trì: <span class='o_nhap_1cm border' contenteditable style='min-width:300px'></span><br>
      <span class='TAB'></span>Loại đối tượng HN <i>(cá nhân; tổ chức; việc, hiện tượng):</i><span class='o_nhap_1cm border' contenteditable style='min-width:180px'></span><br>
      <span class='TAB'></span>Số hồ sơ: <span class='o_nhap_1cm border' contenteditable style='min-width:500px'></span><br>
      <i><span class='TAB'></span>(Thời gian: Từ ngày <span class="o_nhap_ngay border" contenteditable="">...</span>
      tháng<span class="o_nhap_thang border" contenteditable="">...</span>
      năm 20<span class="o_nhap_nam border" contenteditable="">....</span>
      đến ngày<span class="o_nhap_ngay border" contenteditable="">...</span>
      tháng<span class="o_nhap_thang border" contenteditable="">...</span>
      năm 20<span class="o_nhap_nam border" contenteditable="">....)</span></i>
      <table class='table_mau_pa' style="width: 100%;border: 1px; border-collapse: collapse; border-color: black; border-style:solid; font-size:16px; margin-top:10px";
      border="1px" cellpadding="0" cellspacing="0" id="Table3" >
      <tr class=''>
        <td class="Table_TH font12" style="width: 1.2cm; text-align:center"><b>STT</b></td>
      <td class="Table TH font12" style="min-width:6cm; text-align:center"><b>Nội dung tiêu chí chấm điểm</b></td>
      <td class="Table_TH font12" style="width: 1.5cm; text-align:center"><b>Mức<br>điểm</b></td>
      <td class="Table TH font12" style="width: 1.9cm; text-align:center"><b>Cán bộ<br>tự<br>chấm</b></td>
      <td class="Table_TH font12" style="width: 2cm; text-align:center"><b>LĐ, CH <br>phụ trách<br>chấm</b></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>1</td>
      <td style="text-align:justify"><div class="div in_td" >Xác lập HN</div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" >10</div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb" id='tong_diem_cb_muc_1' ></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_ch" id='tong_diem_ch_muc_1'></div></td>
      </tr>
      <tr>
        <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>1.1</i></td>
        <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Thu thập đủ thông tin, tài liệu làm căn cứ để xác lập HN đúng quy định, đúng phân công, phân cấp</i></div></td>
          <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>05</i></div></td>
          <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_1" contentEditable ></div></td>
          <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_1" contentEditable ></div></td>
        </tr>
        <tr>
        <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>1.2</i></td>
        <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Báo cáo đề xuất xác lập HN, quyết định xác lập HN, được lãnh đạo có thẩm quyền phê duyệt</i></div></td>
          <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>05</i></div></td>
          <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_1" contentEditable ></div></td>
          <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_1" contentEditable ></div></td>
        </tr>
        <tr>
          <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>2</td>
          <td style="text-align:justify"><div class="div in_td" >Kế hoạch xác minh HN: Bảo đảm đầy đủ, cụ thể hóa các nội dung về mục đích, yêu cầu, nội dung, phương pháp (biện pháp), thời gian thực hiện, tổ chức thực hiện sát hợp với đối tượng HN (cá nhân, tổ chức hoặc việc, hiện tượng); được lãnh đạo có thẩm quyền phê duyệt</div></td>
          <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" >10</div></td>
          <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_2" contentEditable ></div></td>
          <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_2" contentEditable ></div></td>
          </tr>
          <tr>
          <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>3</td>
          <td style="text-align:justify"><div class="div in_td" >Triển khai kế hoạch xác minh HN đối tượng</div></td>
          <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" >30</div></td>
          <td style="vertical-align:middle;"><div class="ta_center font12 diem cb" id='tong_diem_cb_muc_3' ></div></td>
          <td style="vertical-align:middle;"><div class="ta_center font12 diem_ch" id='tong_diem_ch_muc_3'></div></td>
          </tr>
          <tr>
            <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>3.1</i></td>
            <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Tổ chức triển khai thực hiện đầy đủ các nội dung, biện pháp xác minh HN theo kế hoạch và quy định</i></div></td>
              <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>10</i></div></td>
              <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_3" contentEditable ></div></td>
              <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_3" contentEditable ></div></td>
            </tr>
            <tr>
              <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>3.2</i></td>
              <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Xây dựng, sử dụng được cộng tác viên bí mật phục vụ xác minh HN có hiệu quả hoặc có áp dụng một trong các biện pháp trinh sát nội tuyến, ngoại tuyến, kỹ thuật nghiệp vụ phục vụ xác minh HN</i></div></td>
                <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>10</i></div></td>
                <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_3" contentEditable ></div></td>
                <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_3" contentEditable ></div></td>
              </tr>
              <tr>
                <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>3.3</i></td>
                <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Thời gian xác minh HN đúng quy định</i></div></td>
                  <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>10</i></div></td>
                  <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_3" contentEditable ></div></td>
                  <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_3" contentEditable ></div></td>
                </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>4</td>
      <td style="text-align:justify"><div class="div in_td" >Kết quả xác minh HN</div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" >40</div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_4" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_4" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>4.1</td>
      <td style="text-align:justify"><div class="div in_td" ><i>Xác lập được chuyên án để đấu tranh hoặc đề nghị xác lập chuyên án hoặc nhập vào chuyên án đang đấu tranh</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" ><i>40</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_4" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_4" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>4.2</td>
      <td style="text-align:justify"><div class="div in_td" ><i>Đủ tài liệu, chứng cứ để chứng minh tội phạm và chuyển khởi tố vụ án/bị can hoặc trực tiếp khởi tố vụ án/bị can</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" ><i>40</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_4" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_4" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>4.3</td>
      <td style="text-align:justify"><div class="div in_td" ><i>Đủ tài liệu, chứng cứ về hành vi vi phạm pháp luật của đối tượng nhưng chưa đến mức truy cứu trách nhiệm hình sự, chuyển xử lý vi phạm hành chính</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" ><i>20</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_4" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_4" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>4.4</td>
      <td style="text-align:justify"><div class="div in_td" ><i>Loại khỏi HN do không có hoạt động phạm tội nhưng có thông tin, tài liệu làm rõ được đối tượng có những hành vi vi phạm pháp luật khác với căn cứ xác lập hiềm nghi và chuyển giao cho cơ quan, đơn vị có thẩm quyền xử lý</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" ><i>10</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_4" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_4" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>4.5</td>
      <td style="text-align:justify"><div class="div in_td" ><i>Loại khỏi HN việc, hiện tượng do xác minh đối tượng không còn dấu hiệu hiềm nghi nhưng đã phát hiện, thu thập đủ thông tin, tài liệu làm căn cứ đưa được một hoặc một số đối tượng có liên quan trong hiềm nghi vào sưu tra</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" ><i>10</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_4" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_4" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>4.6</td>
      <td style="text-align:justify"><div class="div in_td" ><i>Kết thúc HN về người (cá nhân) trong trường hợp đang xác minh HN thì đối tượng HN chết</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" ><i>10</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_4" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_4" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>5</td>
      <td style="text-align:justify"><div class="div in_td" >Thực hiện công tác hồ sơ</div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" >10</div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_5" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_5" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td" ></div>6</td>
      <td style="text-align:justify"><div class="div in_td" >Điểm trừ (-)</div></td>
      <td style="vertical-align: middle;" class="ta_center font12"><div class="div_in_td" >-100</div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem cb" id='tong_diem_cb_muc_6' ></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_ch" id='tong_diem_ch_muc_6'></div></td>
      </tr>
      <tr>
               
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>6.1</i></td>
      <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Xác lập HN không đúng quy định (không đúng đối tượng; chưa đủ thông tin, tài liệu làm căn cứ)</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>-100</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_6" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_6" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>6.2</i></td>
      <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Xác lập HN không đúng phân công, phân cấp</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>-50</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_6" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_6" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>6.3</i></td>
      <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Đối tượng HN về người (cá nhân) bị đơn vị khác trong ngành Công an bắt, xử lý hình sự về hành vi phạm tội thuộc chức năng, nhiệm vụ của đơn vị (trừ trường hợp đã có sự phối hợp giữa hai đơn vị trước khi bắt, xử lý hoặc đối tượng bị bắt ở ngoài địa bàn quản lý của đơn vị lập hồ sơ xác minh HN) thì căn cứ vào tính chất và mức độ hành vi phạm tội của đối tượng để trừ điểm: Phạm tội ít nghiêm trọng: Trừ 25 điểm; phạm tội nghiêm trọng: Trừ 50 điểm; Phạm tội rất nghiêm trọng: Trừ 75 điểm; Phạm tội đặc biệt nghiêm trọng: Trừ 100 điểm</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>-25 <br> hoặc <br>  -50 <br> hoặc <br>-75 <br> hoặc <br>-100</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_6" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_6" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>6.4</i></td>
      <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Thời hạn xác minh HN không đúng quy định</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>-30</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_6" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_6" contentEditable ></div></td>
      </tr>
      <tr>
      <td style="vertical-align:middle; text-align: center" class="font12"><div class="div_in_td"></div><i>6.5</i></td>
      <td style="vertical-align: middle;" class="font12" style="text-align:justify"><div class="div_in_td" > <i>Kết thúc HN không đúng quy định hoặc không kết thúc HN theo quy định</i></div></td>
      <td style="vertical-align: middle;" class="ta_center font12 "><div class="div_in_td" ><i>-100</i></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 diem_cb_muc_6" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 diem_ch_muc_6" contentEditable ></div></td>
      </tr>
      <tr>
      <td colspan="3" style="vertical-align: middle;text-align: center;" class="font12" ><div class="div_in_td" > <b>Cộng</b></div></td>
      <td style="vertical-align:middle;"><div class="ta_center font12 " id="sum_all_cb" contentEditable ></div></td>
      <td style="vertical-align:middle;" ><div class="ta_center font12 " id="sum_all_ch" contentEditable ></div></td>
      </tr>
          
      </table>
      <br>
      <div style="margin-left: 1cm;" class="font14 clean"><br>
        <b>1. Kết quả chấm điểm, xếp loại do cán bộ tự thực hiện:</b>
        <div style="width: 100%; margin-top: 10px; text-align: right;">
          <div id="ngayThang" style="display: inline-block; text-align: left;">
            <div>
              <i><span class="dia_danh border" contenteditable="">..................</span>,
              ngày <span class="o_nhap_ngay border" contenteditable="">...</span>
              tháng <span class="o_nhap_thang border" contenteditable="">...</span>
              năm 20<span class="o_nhap_nam border" contenteditable="">....</span></i>
            </div>
            <div style="text-align: center; margin-top: 20px;">
              <b>CÁN BỘ</b><br>
              <i class="font12">(Ký, cấp bậc, họ tên)</i>
            </div>
          </div>
        </div>
        <div style="margin-top: 20px;">
          <div id="tongDiemCb">- Tổng số điểm đạt được: ..................</div>
          <div id="mucXepLoaiCb" style="margin-top: 10px;">- Mức xếp loại: ......................</div>
        </div>
      </div>
      <br><br><br><br>
      <div style="margin-left: 1cm;" class="font14 clean"><br>
        <b>2. Kết quả chấm điểm, xếp loại do lãnh đạo, chỉ huy phụ trách thực hiện:</b>
        <div style="width: 100%; margin-top: 10px; text-align: right;">
          <div id="ngayThang" style="display: inline-block; text-align: left;">
            <div>
              <i><span class="dia_danh border" contenteditable="">..................</span>,
              ngày <span class="o_nhap_ngay border" contenteditable="">...</span>
              tháng <span class="o_nhap_thang border" contenteditable="">...</span>
              năm 20<span class="o_nhap_nam border" contenteditable="">....</span></i>
            </div>
            <div style="text-align: center; margin-top: 20px;">
              <b>LÃNH ĐẠO, CHỈ HUY PHỤ TRÁCH</b><br>
              <i class="font12">(Ký, cấp bậc, họ tên, chức vụ)</i>
            </div>
          </div>
        </div>
        <div style="margin-top: 20px;">
          <div id="tongDiemCh">- Tổng số điểm đạt được: ..................</div>
          <div id="mucXepLoaiCh" style="margin-top: 10px;">- Mức xếp loại: ......................</div>
        </div>
      </div>
      <!-- Nút Random Data và Lưu -->
      <div style="margin-bottom: 10px;">
        <button onclick="generateRandomData()" style="padding:6px 16px;margin-right:10px;">Random Data</button>
        <button onclick="saveForm()" style="padding:6px 16px;">Lưu</button>
      </div>
      <!-- End Nút Random Data và Lưu -->
      <img src="./../images/print.png" class="button_print" width="50px" height="50px" onclick="In_bieu_mau();"><br>
      <img src="./../images/save.png" class="button_save" width="45px" height="45px" onclick="save()";><br>
      <img src="./../images/reload.png" class="button_reload" width="45px" height="45px" onclick="window.location.reload(true);">
    </div>

    <footer class="main-footer" style="text-align: center;">
      <p>&copy; 2024 Hệ thống chấm điểm HSNV. Phát triển bởi đội ngũ chuyên môn.</p>
    </footer>
  </div>
  <script>
    function collectFormData() {
      // Thông tin cá nhân & đối tượng
      const info = {
        ho_ten: document.querySelector("span[contenteditable][style*='min-width:500px']")?.textContent || "",
        cap_bac: document.querySelectorAll("span[contenteditable][style*='min-width: 200px']")[0]?.textContent || "",
        chuc_vu: document.querySelectorAll("span[contenteditable][style*='min-width: 200px']")[1]?.textContent || "",
        don_vi: document.querySelector("span.o_nhap_thang.border[contenteditable]")?.textContent || "",
        ten_doi_tuong: document.querySelector("span[contenteditable][style*='min-width:300px']")?.textContent || "",
        loai_doi_tuong: document.querySelectorAll("span.o_nhap_1cm.border[contenteditable]")[4]?.textContent || "",
        so_ho_so: document.querySelectorAll("span.o_nhap_1cm.border[contenteditable]")[5]?.textContent || "",
        thoi_gian_tu_ngay: document.querySelectorAll('.o_nhap_ngay.border[contenteditable]')[0]?.textContent || "",
        thoi_gian_tu_thang: document.querySelectorAll('.o_nhap_thang.border[contenteditable]')[0]?.textContent || "",
        thoi_gian_tu_nam: document.querySelectorAll('.o_nhap_nam.border[contenteditable]')[0]?.textContent || "",
        thoi_gian_den_ngay: document.querySelectorAll('.o_nhap_ngay.border[contenteditable]')[1]?.textContent || "",
        thoi_gian_den_thang: document.querySelectorAll('.o_nhap_thang.border[contenteditable]')[1]?.textContent || "",
        thoi_gian_den_nam: document.querySelectorAll('.o_nhap_nam.border[contenteditable]')[1]?.textContent || "",
        can_bo_dia_danh: document.querySelectorAll('.dia_danh.border[contenteditable]')[0]?.textContent || "",
        lanh_dao_dia_danh: document.querySelectorAll('.dia_danh.border[contenteditable]')[1]?.textContent || ""
      };
      // Bảng chấm điểm
      const score_table = [];
      const rows = document.querySelectorAll('table.table_mau_pa tr');
      for (let i = 1; i < rows.length - 6; i++) { // Loại bỏ header/footer
        const cells = rows[i].querySelectorAll('td');
        if (cells.length >= 5) {
          score_table.push({
            stt: cells[0].innerText.trim(),
            noi_dung: cells[1].innerText.trim(),
            muc_diem: cells[2].innerText.trim(),
            diem_cb: cells[3].innerText.trim(),
            diem_ch: cells[4].innerText.trim()
          });
        }
      }
      // Tổng điểm, xếp loại
      const tong_diem_cb = document.getElementById('sum_all_cb')?.innerText.trim() || "";
      const tong_diem_ch = document.getElementById('sum_all_ch')?.innerText.trim() || "";
      const xep_loai_cb = document.getElementById('mucXepLoaiCb')?.innerText.trim() || "";
      const xep_loai_ch = document.getElementById('mucXepLoaiCh')?.innerText.trim() || "";
      // Ngày tháng cán bộ
      const cb_dia_danh = document.querySelectorAll('.font14.clean .dia_danh.border')[0]?.textContent || "";
      const cb_ngay = document.querySelectorAll('.font14.clean .o_nhap_ngay.border')[0]?.textContent || "";
      const cb_thang = document.querySelectorAll('.font14.clean .o_nhap_thang.border')[0]?.textContent || "";
      const cb_nam = document.querySelectorAll('.font14.clean .o_nhap_nam.border')[0]?.textContent || "";
      // Ngày tháng lãnh đạo
      const ld_dia_danh = document.querySelectorAll('.font14.clean .dia_danh.border')[1]?.textContent || "";
      const ld_ngay = document.querySelectorAll('.font14.clean .o_nhap_ngay.border')[1]?.textContent || "";
      const ld_thang = document.querySelectorAll('.font14.clean .o_nhap_thang.border')[1]?.textContent || "";
      const ld_nam = document.querySelectorAll('.font14.clean .o_nhap_nam.border')[1]?.textContent || "";
      return {
        info, score_table, tong_diem_cb, tong_diem_ch, xep_loai_cb, xep_loai_ch,
        cb_dia_danh, cb_ngay, cb_thang, cb_nam,
        ld_dia_danh, ld_ngay, ld_thang, ld_nam
      };
    }
    function randomString(length) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
      let result = '';
      for (let i = 0; i < length; i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
      return result;
    }
    function randomNumber(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    function generateRandomData() {
      // Thông tin cá nhân
      document.querySelector("span[contenteditable][style*='min-width:500px']").textContent = randomString(8) + ' ' + randomString(6);
      document.querySelectorAll("span[contenteditable][style*='min-width: 200px']")[0].textContent = 'Đại úy';
      document.querySelectorAll("span[contenteditable][style*='min-width: 200px']")[1].textContent = 'Trưởng phòng';
      document.querySelector("span.o_nhap_thang.border[contenteditable]").textContent = 'Phòng PA' + randomNumber(1,9);
      document.querySelector("span[contenteditable][style*='min-width:300px']").textContent = randomString(10);
      document.querySelectorAll("span.o_nhap_1cm.border[contenteditable]")[4].textContent = 'Cá nhân';
      document.querySelectorAll("span.o_nhap_1cm.border[contenteditable]")[5].textContent = 'HS' + randomNumber(100,999);
      // Thời gian
      document.querySelectorAll('.o_nhap_ngay.border[contenteditable]')[0].textContent = randomNumber(1,28);
      document.querySelectorAll('.o_nhap_thang.border[contenteditable]')[0].textContent = randomNumber(1,12);
      document.querySelectorAll('.o_nhap_nam.border[contenteditable]')[0].textContent = randomNumber(20,24);
      document.querySelectorAll('.o_nhap_ngay.border[contenteditable]')[1].textContent = randomNumber(1,28);
      document.querySelectorAll('.o_nhap_thang.border[contenteditable]')[1].textContent = randomNumber(1,12);
      document.querySelectorAll('.o_nhap_nam.border[contenteditable]')[1].textContent = randomNumber(20,24);
      // Địa danh, ngày tháng năm cán bộ
      document.querySelectorAll('.font14.clean .dia_danh.border')[0].textContent = 'Hà Nội';
      document.querySelectorAll('.font14.clean .o_nhap_ngay.border')[0].textContent = randomNumber(1,28);
      document.querySelectorAll('.font14.clean .o_nhap_thang.border')[0].textContent = randomNumber(1,12);
      document.querySelectorAll('.font14.clean .o_nhap_nam.border')[0].textContent = randomNumber(20,24);
      // Địa danh, ngày tháng năm lãnh đạo
      document.querySelectorAll('.font14.clean .dia_danh.border')[1].textContent = 'Hải Phòng';
      document.querySelectorAll('.font14.clean .o_nhap_ngay.border')[1].textContent = randomNumber(1,28);
      document.querySelectorAll('.font14.clean .o_nhap_thang.border')[1].textContent = randomNumber(1,12);
      document.querySelectorAll('.font14.clean .o_nhap_nam.border')[1].textContent = randomNumber(20,24);
      // Bảng điểm - random cho tất cả các ô điểm trong bảng
      // Cán bộ tự chấm
      document.querySelectorAll('td:nth-child(4) [contenteditable], td:nth-child(4) > div[contenteditable], td:nth-child(4) > div:not([contenteditable])').forEach(e => {
        if (e.closest('tr') && e.closest('tr').querySelectorAll('td').length >= 5) {
          e.textContent = randomNumber(0, 10);
        }
      });
      // Lãnh đạo chấm
      document.querySelectorAll('td:nth-child(5) [contenteditable], td:nth-child(5) > div[contenteditable], td:nth-child(5) > div:not([contenteditable])').forEach(e => {
        if (e.closest('tr') && e.closest('tr').querySelectorAll('td').length >= 5) {
          e.textContent = randomNumber(0, 10);
        }
      });
      document.getElementById('sum_all_cb').textContent = randomNumber(50,100);
      document.getElementById('sum_all_ch').textContent = randomNumber(50,100);
      document.getElementById('mucXepLoaiCb').textContent = 'A';
      document.getElementById('mucXepLoaiCh').textContent = 'A';
    }
    function saveForm() {
      const data = collectFormData();
      alert(JSON.stringify(data, null, 2));
      console.log(data);
    }
  </script>
  <script>
window.addEventListener('DOMContentLoaded', function() {
  const urlParams = new URLSearchParams(window.location.search);
  const formId = urlParams.get('form_id');
  if (formId) {
    fetch(`/api/forms/dtcb/${encodeURIComponent(formId)}`)
      .then(res => res.json())
      .then(data => {
        if (data && data.info) {
          // Điền dữ liệu vào các trường tương ứng
          document.querySelector("span[contenteditable][style*='min-width:500px']").textContent = data.info.ho_ten || '';
          document.querySelectorAll("span[contenteditable][style*='min-width: 200px']")[0].textContent = data.info.cap_bac || '';
          document.querySelectorAll("span[contenteditable][style*='min-width: 200px']")[1].textContent = data.info.chuc_vu || '';
          document.querySelector("span.o_nhap_thang.border[contenteditable]").textContent = data.info.don_vi || '';
          document.querySelector("span[contenteditable][style*='min-width:300px']").textContent = data.info.ten_doi_tuong || '';
          document.querySelectorAll("span.o_nhap_1cm.border[contenteditable]")[4].textContent = data.info.loai_doi_tuong || '';
          document.querySelectorAll("span.o_nhap_1cm.border[contenteditable]")[5].textContent = data.info.so_ho_so || '';
          document.querySelectorAll('.o_nhap_ngay.border[contenteditable]')[0].textContent = data.info.thoi_gian_tu_ngay || '';
          document.querySelectorAll('.o_nhap_thang.border[contenteditable]')[0].textContent = data.info.thoi_gian_tu_thang || '';
          document.querySelectorAll('.o_nhap_nam.border[contenteditable]')[0].textContent = data.info.thoi_gian_tu_nam || '';
          document.querySelectorAll('.o_nhap_ngay.border[contenteditable]')[1].textContent = data.info.thoi_gian_den_ngay || '';
          document.querySelectorAll('.o_nhap_thang.border[contenteditable]')[1].textContent = data.info.thoi_gian_den_thang || '';
          document.querySelectorAll('.o_nhap_nam.border[contenteditable]')[1].textContent = data.info.thoi_gian_den_nam || '';
          document.querySelectorAll('.dia_danh.border[contenteditable]')[0].textContent = data.info.can_bo_dia_danh || '';
          document.querySelectorAll('.dia_danh.border[contenteditable]')[1].textContent = data.info.lanh_dao_dia_danh || '';
          // Bảng điểm
          if (Array.isArray(data.score_table)) {
            const rows = document.querySelectorAll('table.table_mau_pa tr');
            let idx = 0;
            for (let i = 1; i < rows.length - 6; i++) {
              const cells = rows[i].querySelectorAll('td');
              if (cells.length >= 5 && data.score_table[idx]) {
                cells[3].innerText = data.score_table[idx].diem_cb || '';
                cells[4].innerText = data.score_table[idx].diem_ch || '';
                idx++;
              }
            }
          }
          // Tổng điểm, xếp loại, ngày tháng
          document.getElementById('sum_all_cb').innerText = data.tong_diem_cb || '';
          document.getElementById('sum_all_ch').innerText = data.tong_diem_ch || '';
          document.getElementById('mucXepLoaiCb').innerText = data.xep_loai_cb || '';
          document.getElementById('mucXepLoaiCh').innerText = data.xep_loai_ch || '';
          // Ngày tháng cán bộ, lãnh đạo
          document.querySelectorAll('.font14.clean .dia_danh.border')[0].textContent = data.cb_dia_danh || '';
          document.querySelectorAll('.font14.clean .o_nhap_ngay.border')[0].textContent = data.cb_ngay || '';
          document.querySelectorAll('.font14.clean .o_nhap_thang.border')[0].textContent = data.cb_thang || '';
          document.querySelectorAll('.font14.clean .o_nhap_nam.border')[0].textContent = data.cb_nam || '';
          document.querySelectorAll('.font14.clean .dia_danh.border')[1].textContent = data.ld_dia_danh || '';
          document.querySelectorAll('.font14.clean .o_nhap_ngay.border')[1].textContent = data.ld_ngay || '';
          document.querySelectorAll('.font14.clean .o_nhap_thang.border')[1].textContent = data.ld_thang || '';
          document.querySelectorAll('.font14.clean .o_nhap_nam.border')[1].textContent = data.ld_nam || '';
        }
      });
  }
});
</script>

</body>
</html>






    
  




  
  

  
  




